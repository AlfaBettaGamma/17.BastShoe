
Делаем национальный редактор "Лапоть"

В рамках проекта тотального импортозамещения решено полностью с нуля переписать весь офисный софт в стране. Вы получили подряд с бюджетом миллион рублей по созданию оригинального текстового редактора "Лапоть". Закодируйте его максимально компактно!

"Лапоть" поддерживает пять операций:

1. Добавить(S) -- в конец текущей строки (исходно пустая) добавляется строка S;

2. Удалить(N) -- удалить N символов из конца текущей строки;

3. Выдать(i) -- выдать i-й символ текущей строки;

4. Undo() -- отмена последней операции 1 или 2; отмена должна уметь выполняться при необходимости неограниченное число раз;

5. Redo() -- выполнить заново последнюю отменённую с помощью Undo операцию; Redo должна уметь выполняться при необходимости неограниченное число раз.
Если после Undo выполняется операция 1 или 2, то Redo более становится нечего отказывать.

Лапоть должен информировать о случаях некорректного задания команды.

На вход редактора подаётся одна строка, первый символ которой -- номер операции (1-4) и через пробел, при необходимости, параметр соответствующей операции.

Например:

1 Привет 
В текущей строке будет "Привет"
1  , Мир!
Привет, Мир!
1 ++ 
Привет, Мир!++
2 2
Привет, Мир!
4
Привет, Мир!++
4
Привет, Мир!
1 *
Привет, Мир!*
4
Привет, Мир!
4 
Привет, Мир!
4
Привет, Мир!
3 7
,
2 100

1 Привет 
Привет
1  , Мир!
Привет, Мир!
1 ++ 
Привет, Мир!++
4
Привет, Мир!
4
Привет
5
Привет, Мир!
4
Привет
5
Привет, Мир!
5
Привет, Мир!++
5
Привет, Мир!++
5
Привет, Мир!++
4
Привет, Мир!
4
Привет
2 2
Прив
4
Привет
5
Прив
5
Прив
5
Прив

Функция

string BastShoe(string command)          

получает на вход строку в формате "N параметр", где N -- код операции (1-5), и возвращает текущую строку.
Например, BastShoe("1 Привет") = "Привет" 